# Agent Team Monitor - é¡¹ç›®æ€»ç»“

## ğŸ¯ é¡¹ç›®ç›®æ ‡

åˆ›å»ºä¸€ä¸ªè·¨å¹³å°ï¼ˆmacOS/Linuxï¼‰çš„ç›‘æ§å·¥å…·ï¼Œç”¨äºå®æ—¶è¿½è¸ª Claude Code åˆ›å»ºçš„æ‰€æœ‰ agent team çš„æ´»åŠ¨çŠ¶æ€ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. æ ¸å¿ƒç›‘æ§åŠŸèƒ½
- âœ… **è¿›ç¨‹ç›‘æ§**: ä½¿ç”¨ gopsutil æ£€æµ‹è¿è¡Œä¸­çš„ Claude Code è¿›ç¨‹
- âœ… **å›¢é˜Ÿç›‘æ§**: æ‰«æå¹¶è§£æ `~/.claude/teams/` ç›®å½•ä¸­çš„å›¢é˜Ÿé…ç½®
- âœ… **ä»»åŠ¡ç›‘æ§**: è¯»å– `~/.claude/tasks/` ä¸­çš„ä»»åŠ¡çŠ¶æ€æ–‡ä»¶
- âœ… **å®æ—¶æ›´æ–°**: ç»“åˆæ–‡ä»¶ç³»ç»Ÿç›‘æ§ï¼ˆfsnotifyï¼‰å’Œå®šæœŸè½®è¯¢

### 2. æ•°æ®è§£æ
- âœ… å›¢é˜Ÿé…ç½®è§£æï¼ˆJSONï¼‰
- âœ… ä»»åŠ¡çŠ¶æ€è§£æï¼ˆJSONï¼‰
- âœ… Agent çŠ¶æ€æ¨æ–­ï¼ˆåŸºäºä»»åŠ¡æ‰€æœ‰æƒï¼‰
- âœ… æ—¶é—´æˆ³å¤„ç†ï¼ˆRFC3339 æ ¼å¼ï¼‰

### 3. ç”¨æˆ·ç•Œé¢
- âœ… ç¾è§‚çš„ç»ˆç«¯ TUIï¼ˆBubble Tea + Lipglossï¼‰
- âœ… å½©è‰²çŠ¶æ€æŒ‡ç¤ºå™¨
- âœ… å®æ—¶è‡ªåŠ¨åˆ·æ–°ï¼ˆæ¯ç§’ï¼‰
- âœ… æ‰‹åŠ¨åˆ·æ–°åŠŸèƒ½ï¼ˆæŒ‰ 'r'ï¼‰
- âœ… ä¼˜é›…é€€å‡ºï¼ˆæŒ‰ 'q' æˆ– Ctrl+Cï¼‰

### 4. è·¨å¹³å°æ”¯æŒ
- âœ… macOS æ”¯æŒï¼ˆIntel + Apple Siliconï¼‰
- âœ… Linux æ”¯æŒï¼ˆx86_64 + ARM64ï¼‰
- âœ… è·¨å¹³å°æ„å»ºè„šæœ¬

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯é€‰å‹
```
è¯­è¨€: Go 1.25
â”œâ”€â”€ TUI æ¡†æ¶: Bubble Tea + Lipgloss
â”œâ”€â”€ è¿›ç¨‹ç›‘æ§: gopsutil v3.24.5
â”œâ”€â”€ æ–‡ä»¶ç›‘æ§: fsnotify v1.8.0
â””â”€â”€ æ„å»ºå·¥å…·: Make
```

### ä»£ç ç»“æ„
```
agent-team-monitor/
â”œâ”€â”€ cmd/monitor/          # ä¸»ç¨‹åºå…¥å£
â”‚   â””â”€â”€ main.go          # å¯åŠ¨é€»è¾‘ã€ä¿¡å·å¤„ç†
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ types/           # å…±äº«æ•°æ®ç±»å‹
â”‚   â”‚   â””â”€â”€ types.go     # TeamInfo, AgentInfo, TaskInfo, ProcessInfo
â”‚   â”œâ”€â”€ monitor/         # ç›‘æ§æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ process.go   # è¿›ç¨‹æ£€æµ‹ï¼ˆgopsutilï¼‰
â”‚   â”‚   â”œâ”€â”€ filesystem.go # æ–‡ä»¶ç³»ç»Ÿç›‘æ§ï¼ˆfsnotifyï¼‰
â”‚   â”‚   â””â”€â”€ collector.go # æ•°æ®èšåˆã€çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ parser/          # é…ç½®è§£æ
â”‚   â”‚   â”œâ”€â”€ team.go      # å›¢é˜Ÿé…ç½® JSON è§£æ
â”‚   â”‚   â””â”€â”€ task.go      # ä»»åŠ¡æ–‡ä»¶ JSON è§£æ
â”‚   â””â”€â”€ ui/              # ç”¨æˆ·ç•Œé¢
â”‚       â””â”€â”€ tui.go       # Bubble Tea TUI å®ç°
â”œâ”€â”€ Makefile             # æ„å»ºè„šæœ¬
â”œâ”€â”€ test-setup.sh        # æµ‹è¯•æ•°æ®ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ README.md            # è‹±æ–‡æ–‡æ¡£
â””â”€â”€ README.zh-CN.md      # ä¸­æ–‡æ–‡æ¡£
```

## ğŸ” æ ¸å¿ƒå®ç°ç»†èŠ‚

### 1. ç›‘æ§ç­–ç•¥ï¼ˆæ··åˆæ¨¡å¼ï¼‰
```go
// æ–‡ä»¶ç³»ç»Ÿç›‘æ§ï¼ˆå®æ—¶ï¼‰
fsnotify.Watcher -> ç›‘å¬ ~/.claude/teams/ å’Œ ~/.claude/tasks/
  â””â”€> æ–‡ä»¶å˜åŒ– -> è§¦å‘æ›´æ–°ï¼ˆ100ms é˜²æŠ–ï¼‰

// å®šæœŸè½®è¯¢ï¼ˆæ¯ 5 ç§’ï¼‰
time.Ticker -> å®šæœŸæ‰«æ
  â””â”€> ç¡®ä¿ä¸é—æ¼å˜åŒ– + æ›´æ–°è¿›ç¨‹ä¿¡æ¯
```

### 2. Agent çŠ¶æ€æ¨æ–­
```go
if agent.has_task_with_status("in_progress") {
    status = "WORKING"
} else if agent.has_completed_tasks() {
    status = "IDLE"
} else {
    status = "IDLE"
}
```

### 3. æ•°æ®æµ
```
è¿›ç¨‹æ‰«æ â”€â”€â”
           â”œâ”€â”€> Collector â”€â”€> MonitorState â”€â”€> TUI â”€â”€> ç»ˆç«¯æ˜¾ç¤º
æ–‡ä»¶æ‰«æ â”€â”€â”˜
```

## ğŸ“Š ç›‘æ§æ•°æ®ç»“æ„

### MonitorState
```go
type MonitorState struct {
    Teams     []TeamInfo      // æ‰€æœ‰å›¢é˜Ÿ
    Processes []ProcessInfo   // Claude è¿›ç¨‹
    UpdatedAt time.Time       // æœ€åæ›´æ–°æ—¶é—´
}
```

### TeamInfo
```go
type TeamInfo struct {
    Name       string         // å›¢é˜Ÿåç§°
    CreatedAt  time.Time      // åˆ›å»ºæ—¶é—´
    Members    []AgentInfo    // æˆå‘˜åˆ—è¡¨
    Tasks      []TaskInfo     // ä»»åŠ¡åˆ—è¡¨
    ConfigPath string         // é…ç½®æ–‡ä»¶è·¯å¾„
}
```

### AgentInfo
```go
type AgentInfo struct {
    Name         string       // Agent åç§°
    AgentID      string       // Agent ID
    AgentType    string       // Agent ç±»å‹
    Status       string       // idle/working/completed
    CurrentTask  string       // å½“å‰ä»»åŠ¡ ID
    LastActivity time.Time    // æœ€åæ´»åŠ¨æ—¶é—´
}
```

## ğŸ¨ UI è®¾è®¡

### å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Claude Agent Team Monitor            â”‚
â”‚ Last updated: 23:05:42                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š Claude Processes (2 running)         â”‚
â”‚   PID: 12345 | Uptime: 2h 15m           â”‚
â”‚   PID: 67890 | Uptime: 45m              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘¥ Active Teams (1 teams)               â”‚
â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚ â”‚ Team: test-team                     â”‚ â”‚
â”‚ â”‚ Created: 2026-02-10 20:30           â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ Agents:                             â”‚ â”‚
â”‚ â”‚   â€¢ researcher [Explore] - IDLE     â”‚ â”‚
â”‚ â”‚   â€¢ developer [general] - WORKING   â”‚ â”‚
â”‚ â”‚     (Task: task-2)                  â”‚ â”‚
â”‚ â”‚   â€¢ tester [test-runner] - IDLE     â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ Tasks:                              â”‚ â”‚
â”‚ â”‚   [task-1] Research - COMPLETED     â”‚ â”‚
â”‚ â”‚   [task-2] Implement - IN PROGRESS  â”‚ â”‚
â”‚ â”‚   [task-3] Test - PENDING           â”‚ â”‚
â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Press 'r' to refresh | 'q' to quit      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢œè‰²æ–¹æ¡ˆ
- æ ‡é¢˜: ç´«è‰² (#7D56F4)
- å›¢é˜Ÿè¾¹æ¡†: ç´«è‰² (#874BFD)
- Agent: ç»¿è‰² (#04B575)
- Task: æ©™è‰² (#FFA500)
- Process: çº¢è‰² (#FF6B6B)
- WORKING: äº®ç»¿è‰² (#00FF00)
- IDLE: é»„è‰² (#FFFF00)
- COMPLETED: ç°è‰² (#888888)

## ğŸš€ ä½¿ç”¨æ–¹å¼

### åŸºæœ¬ä½¿ç”¨
```bash
# æ„å»º
make build

# è¿è¡Œ
./bin/agent-team-monitor

# æˆ–ç›´æ¥è¿è¡Œ
make run
```

### æµ‹è¯•ç¯å¢ƒ
```bash
# åˆ›å»ºæµ‹è¯•æ•°æ®
./test-setup.sh

# è¿è¡Œç›‘æ§å™¨
./bin/agent-team-monitor

# æ¸…ç†æµ‹è¯•æ•°æ®
rm -rf ~/.claude/teams/test-team ~/.claude/tasks/test-team
```

### å¤šå¹³å°æ„å»º
```bash
make build-all
# ç”Ÿæˆï¼š
# - agent-team-monitor-darwin-amd64
# - agent-team-monitor-darwin-arm64
# - agent-team-monitor-linux-amd64
# - agent-team-monitor-linux-arm64
```

## ğŸ“ˆ æ€§èƒ½ç‰¹ç‚¹

- **äºŒè¿›åˆ¶å¤§å°**: ~5MBï¼ˆå•ä¸€å¯æ‰§è¡Œæ–‡ä»¶ï¼‰
- **å†…å­˜å ç”¨**: < 20MBï¼ˆç©ºé—²æ—¶ï¼‰
- **CPU å ç”¨**: < 1%ï¼ˆæ­£å¸¸ç›‘æ§ï¼‰
- **å¯åŠ¨æ—¶é—´**: < 100ms
- **æ›´æ–°å»¶è¿Ÿ**: < 200msï¼ˆæ–‡ä»¶å˜åŒ–åˆ°æ˜¾ç¤ºï¼‰

## ğŸ”’ å®‰å…¨è€ƒè™‘

- âœ… åªè¯»æ“ä½œï¼ˆä¸ä¿®æ”¹ä»»ä½•æ–‡ä»¶ï¼‰
- âœ… æœ¬åœ°æ–‡ä»¶è®¿é—®ï¼ˆä¸æ¶‰åŠç½‘ç»œï¼‰
- âœ… ç”¨æˆ·æƒé™èŒƒå›´å†…è¿è¡Œ
- âœ… ä¼˜é›…çš„é”™è¯¯å¤„ç†ï¼ˆä¸ä¼šå´©æºƒï¼‰

## ğŸ§ª æµ‹è¯•è¦†ç›–

### å·²æµ‹è¯•åœºæ™¯
- âœ… æ— å›¢é˜Ÿæ—¶çš„æ˜¾ç¤º
- âœ… å•ä¸ªå›¢é˜Ÿå¤šä¸ª agent
- âœ… å¤šç§ä»»åŠ¡çŠ¶æ€
- âœ… æ–‡ä»¶ç³»ç»Ÿå˜åŒ–å“åº”
- âœ… è¿›ç¨‹æ£€æµ‹
- âœ… ä¼˜é›…é€€å‡º

### å¾…æµ‹è¯•åœºæ™¯
- â³ å¤§é‡å›¢é˜Ÿï¼ˆ10+ï¼‰
- â³ å¤§é‡ä»»åŠ¡ï¼ˆ100+ï¼‰
- â³ é«˜é¢‘æ–‡ä»¶å˜åŒ–
- â³ æƒé™é”™è¯¯å¤„ç†
- â³ æŸåçš„ JSON æ–‡ä»¶

## ğŸ”® æœªæ¥å¢å¼ºæ–¹å‘

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¤§æ•°æ®é›†ï¼‰
- [ ] é”™è¯¯æ—¥å¿—è®°å½•
- [ ] é…ç½®æ–‡ä»¶æ”¯æŒ

### ä¸­æœŸï¼ˆ1-2 æœˆï¼‰
- [ ] Web ä»ªè¡¨æ¿ï¼ˆHTTP API + React å‰ç«¯ï¼‰
- [ ] å†å²æ•°æ®å­˜å‚¨ï¼ˆSQLiteï¼‰
- [ ] å¯¼å‡ºåŠŸèƒ½ï¼ˆJSON/CSVï¼‰
- [ ] å‘Šè­¦é€šçŸ¥ï¼ˆæ¡Œé¢é€šçŸ¥ï¼‰

### é•¿æœŸï¼ˆ3-6 æœˆï¼‰
- [ ] Agent é€šä¿¡æ—¥å¿—æŸ¥çœ‹
- [ ] æ€§èƒ½æŒ‡æ ‡å›¾è¡¨
- [ ] å¤šå®ä¾‹æ”¯æŒ
- [ ] è¿œç¨‹ç›‘æ§ï¼ˆå®¢æˆ·ç«¯-æœåŠ¡å™¨æ¨¡å¼ï¼‰
- [ ] æ’ä»¶ç³»ç»Ÿ

## ğŸ“ å¼€å‘ç¬”è®°

### é‡åˆ°çš„é—®é¢˜åŠè§£å†³

1. **å¾ªç¯å¯¼å…¥é—®é¢˜**
   - é—®é¢˜: `pkg/monitor` å’Œ `pkg/parser` äº’ç›¸å¯¼å…¥
   - è§£å†³: åˆ›å»ºç‹¬ç«‹çš„ `pkg/types` åŒ…å­˜æ”¾å…±äº«ç±»å‹

2. **ç½‘ç»œè¶…æ—¶**
   - é—®é¢˜: Go ä»£ç†è¿æ¥è¶…æ—¶
   - è§£å†³: ä½¿ç”¨å›½å†…é•œåƒ `GOPROXY=https://goproxy.cn`

3. **æ–‡ä»¶ç³»ç»Ÿç›‘æ§**
   - é—®é¢˜: éœ€è¦ç›‘æ§å­ç›®å½•
   - è§£å†³: é€’å½’æ·»åŠ  watcher + ç›‘å¬ CREATE äº‹ä»¶

### æœ€ä½³å®è·µ

- âœ… ä½¿ç”¨ `sync.RWMutex` ä¿æŠ¤å…±äº«çŠ¶æ€
- âœ… ä½¿ç”¨ channel è¿›è¡Œ goroutine é€šä¿¡
- âœ… ä¼˜é›…çš„ä¿¡å·å¤„ç†ï¼ˆSIGINT/SIGTERMï¼‰
- âœ… é˜²æŠ–æœºåˆ¶é¿å…é¢‘ç¹æ›´æ–°
- âœ… é”™è¯¯æ—¥å¿—è€Œéå´©æºƒ

## ğŸ“ å­¦ä¹ æ”¶è·

1. **Go å¹¶å‘æ¨¡å¼**: goroutines + channels + mutex
2. **TUI å¼€å‘**: Bubble Tea æ¶æ„ï¼ˆModel-Update-Viewï¼‰
3. **æ–‡ä»¶ç³»ç»Ÿç›‘æ§**: fsnotify çš„ä½¿ç”¨å’Œé™·é˜±
4. **è·¨å¹³å°å¼€å‘**: å¤„ç†ä¸åŒ OS çš„å·®å¼‚
5. **é¡¹ç›®ç»“æ„**: æ¸…æ™°çš„åŒ…ç»„ç»‡å’Œä¾èµ–ç®¡ç†

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **ä»£ç è¡Œæ•°**: ~800 è¡Œ Go ä»£ç 
- **æ–‡ä»¶æ•°é‡**: 12 ä¸ªæºæ–‡ä»¶
- **ä¾èµ–æ•°é‡**: 4 ä¸ªç›´æ¥ä¾èµ–
- **å¼€å‘æ—¶é—´**: ~2 å°æ—¶
- **æ„å»ºæ—¶é—´**: ~3 ç§’

## ğŸ‰ æ€»ç»“

æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜ç§€ã€ç”¨æˆ·å‹å¥½çš„ Claude Agent Team ç›‘æ§å·¥å…·ã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£ Go å¼€å‘å®è·µï¼Œå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**:
- ğŸš€ å•ä¸€äºŒè¿›åˆ¶ï¼Œæ— éœ€ä¾èµ–
- âš¡ å®æ—¶ç›‘æ§ï¼Œä½å»¶è¿Ÿ
- ğŸ¨ ç¾è§‚ç•Œé¢ï¼Œæ˜“äºä½¿ç”¨
- ğŸ–¥ï¸ è·¨å¹³å°ï¼Œå…¼å®¹æ€§å¥½
- ğŸ“¦ æ˜“äºéƒ¨ç½²å’Œåˆ†å‘

**é€‚ç”¨åœºæ™¯**:
- Claude Code å¼€å‘è€…ç›‘æ§ agent teams
- è°ƒè¯• agent åä½œé—®é¢˜
- è¿½è¸ªä»»åŠ¡è¿›åº¦
- æ€§èƒ½åˆ†æå’Œä¼˜åŒ–
